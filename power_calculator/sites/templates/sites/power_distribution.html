{% load static %} {% load site_extras %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Power Distribution</title>
    <link
      rel="stylesheet"
      href="{% static 'sites/css/power_distribution.css' %}"
    />
  </head>

  <body>
    <h1>{{ site_code|upper }}</h1>

    <div class="layout">
      <!-- LEFT SIDEBAR: PARENTS ONLY -->
      <div class="sidebar">
        <h3>Parent Strips</h3>
        <ul>
          {% for parent in parents %}
          <li>
            <a href="?parent={{ parent.name }}"> {{ parent.name }} </a>
          </li>
          {% endfor %}
        </ul>
      </div>

      <!-- RIGHT CONTENT: CHILDREN ONLY -->
      <div class="content">
        {% if not selected_parent %}
        <p>Select a parent strip from the left.</p>
        {% else %}

        <h2>{{ selected_parent.name }}</h2>

        {% for child in selected_parent.enriched_child_strips %}
        <h3>{{ child }}</h3>

        <table border="1">
          <tr>
            <th>Slot</th>
            <th>Device</th>
            <th>Amperes</th>
          </tr>

          {% for slot_num in slot_range %}
          <tr>
            <td>{{ slot_num }}</td>

            {% with device=child.slots|get_item:slot_num %} {% if device %}
            <td>{{ device.template.model }}</td>
            <td>{{ device.template.power }}A</td>
            {% else %}
            <td>None</td>
            <td>0A</td>
            {% endif %} {% endwith %}
          </tr>
          {% endfor %}

          <tr>
            <td colspan="2"><strong>Total</strong></td>
            <td><strong>{{ child.total_power_value }}A</strong></td>
          </tr>
        </table>

        <br />
        <a href="{% url 'edit_child' site_code child.id %}">Edit</a>
        <hr />

        {% endfor %} {% endif %}
      </div>
    </div>
  </body>
</html>
